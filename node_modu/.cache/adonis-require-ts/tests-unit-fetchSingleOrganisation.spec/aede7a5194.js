"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const runner_1 = require("@japa/runner");
const sinon_1 = __importDefault(require("sinon"));
const FetchSingleOrganisationController_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Controllers/Http/FetchSingleOrganisationController"));
const UserAction_1 = global[Symbol.for('ioc.use')]("App/Actions/UserAction");
runner_1.test.group('FetchSingleOrganisationController', (group) => {
    let sandbox;
    group.setup(async () => {
        sandbox = sinon_1.default.createSandbox();
    });
    group.teardown(async () => {
        sandbox.restore();
    });
    group.each.teardown = () => {
        sandbox.restore();
    };
    (0, runner_1.test)('should return 200 and organisation data if organisation is found', async ({ assert }) => {
        const controller = new FetchSingleOrganisationController_1.default();
        const fakeUser = { userId: '123e4567-e89b-12d3-a456-426614174000' };
        const orgId = '123e4567-e89b-12d3-a456-426614174001';
        const fakeOrganisations = [{ orgId: '123e4567-e89b-12d3-a456-426614174001', name: 'Test Org', description: "a random organisation" }];
        sandbox.stub(UserAction_1.UserActions, 'fetchUserOrganisations').resolves(fakeOrganisations);
        const request = {
            param: sandbox.stub().returns(orgId)
        };
        const response = {
            status: sandbox.stub().returnsThis(),
            send: sandbox.stub()
        };
        const auth = {
            user: fakeUser
        };
        const ctx = { request, response, auth };
        await controller.handle(ctx);
        assert.isTrue(response.status.calledWith(200));
        assert.isTrue(response.send.calledWith({
            status: "success",
            message: "Organisation fetched successfully",
            data: fakeOrganisations[0]
        }));
    });
    (0, runner_1.test)('should return 404 if organisation is not found', async ({ assert }) => {
        const controller = new FetchSingleOrganisationController_1.default();
        const fakeUser = { userId: '123e4567-e89b-12d3-a456-426614174000' };
        const orgId = '123e4567-e89b-12d3-a456-426614174001';
        const fakeOrganisations = [{ orgId: '123e4567-e89b-12d3-a456-426614174002', name: 'Other Org', description: "nice description" }];
        sandbox.stub(UserAction_1.UserActions, 'fetchUserOrganisations').resolves(fakeOrganisations);
        const request = {
            param: sandbox.stub().returns(orgId)
        };
        const response = {
            status: sandbox.stub().returnsThis(),
            send: sandbox.stub()
        };
        const auth = {
            user: fakeUser
        };
        const ctx = { request, response, auth };
        await controller.handle(ctx);
        assert.isTrue(response.status.calledWith(404));
        assert.isTrue(response.send.calledWith({
            status: "Bad Request",
            message: "Organisation record not found",
            data: undefined
        }));
    });
    (0, runner_1.test)('should return 500 if an error occurs', async ({ assert }) => {
        const controller = new FetchSingleOrganisationController_1.default();
        const fakeUser = { userId: '123e4567-e89b-12d3-a456-426614174000' };
        const orgId = '123e4567-e89b-12d3-a456-426614174001';
        sandbox.stub(UserAction_1.UserActions, 'fetchUserOrganisations').throws(new Error('Simulated error'));
        const request = {
            param: sandbox.stub().returns(orgId)
        };
        const response = {
            status: sandbox.stub().returnsThis(),
            send: sandbox.stub()
        };
        const auth = {
            user: fakeUser
        };
        const ctx = { request, response, auth };
        await controller.handle(ctx);
        assert.isTrue(response.status.calledWith(500));
        assert.isTrue(response.send.calledWith({
            status: "Error",
            message: "Error Occured Fetching Organisation",
            statusCode: 500
        }));
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmV0Y2hTaW5nbGVPcmdhbmlzYXRpb24uc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImZldGNoU2luZ2xlT3JnYW5pc2F0aW9uLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSx5Q0FBaUM7QUFDakMsa0RBQXlCO0FBQ3pCLHFKQUFzRztBQUN0Ryw2RUFBb0Q7QUFJcEQsYUFBSSxDQUFDLEtBQUssQ0FBQyxtQ0FBbUMsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO0lBQ3RELElBQUksT0FBMkIsQ0FBQTtJQUVqQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssSUFBSSxFQUFFO1FBRXJCLE9BQU8sR0FBRyxlQUFLLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDakMsQ0FBQyxDQUFDLENBQUE7SUFFRixLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1FBQ3hCLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUNuQixDQUFDLENBQUMsQ0FBQTtJQUVGLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsRUFBRTtRQUN6QixPQUFPLENBQUMsT0FBTyxFQUFFLENBQUE7SUFDbkIsQ0FBQyxDQUFBO0lBR0QsSUFBQSxhQUFJLEVBQUMsa0VBQWtFLEVBQUUsS0FBSyxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRTtRQUM1RixNQUFNLFVBQVUsR0FBRyxJQUFJLDJDQUFpQyxFQUFFLENBQUE7UUFFMUQsTUFBTSxRQUFRLEdBQUcsRUFBRSxNQUFNLEVBQUUsc0NBQXNDLEVBQVUsQ0FBQTtRQUMzRSxNQUFNLEtBQUssR0FBRyxzQ0FBc0MsQ0FBQTtRQUNwRCxNQUFNLGlCQUFpQixHQUFHLENBQUMsRUFBRSxLQUFLLEVBQUUsc0NBQXNDLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUMsdUJBQXVCLEVBQUUsQ0FBQyxDQUFBO1FBRXBJLE9BQU8sQ0FBQyxJQUFJLENBQUMsd0JBQVcsRUFB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LHNDQUFzQyxFQUFVLENBQUE7UUFDM0UsTUFBTSxLQUFLLEdBQUcsc0NBQXNDLENBQUE7UUFFcEQsT0FBTyxDQUFDLElBQUksQ0FBQyx3QkFBVyxFQUFFLHdCQUF3QixDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQTtRQUV4RixNQUFNLE9BQU8sR0FBRztZQUNkLEtBQUssRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQztTQUNyQyxDQUFBO1FBRUQsTUFBTSxRQUFRLEdBQUc7WUFDZixNQUFNLEVBQUUsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtZQUNwQyxJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksRUFBRTtTQUNyQixDQUFBO1FBRUQsTUFBTSxJQUFJLEdBQUc7WUFDWCxJQUFJLEVBQUUsUUFBUTtTQUNmLENBQUE7UUFFRCxNQUFNLEdBQUcsR0FBRyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFvQyxDQUFBO1FBRXpFLE1BQU0sVUFBVSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUU1QixNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7UUFDOUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQztZQUNyQyxNQUFNLEVBQUUsT0FBTztZQUNmLE9BQU8sRUFBRSxxQ0FBcUM7WUFDOUMsVUFBVSxFQUFFLEdBQUc7U0FDaEIsQ0FBQyxDQUFDLENBQUE7SUFDTCxDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHt0ZXN0fSBmcm9tICdAamFwYS9ydW5uZXInXG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nXG5pbXBvcnQgRmV0Y2hTaW5nbGVPcmdhbmlzYXRpb25Db250cm9sbGVyIGZyb20gJ0FwcC9Db250cm9sbGVycy9IdHRwL0ZldGNoU2luZ2xlT3JnYW5pc2F0aW9uQ29udHJvbGxlcidcbmltcG9ydCB7IFVzZXJBY3Rpb25zIH0gZnJvbSAnQXBwL0FjdGlvbnMvVXNlckFjdGlvbidcbmltcG9ydCB7IEh0dHBDb250ZXh0Q29udHJhY3QgfSBmcm9tICdAaW9jOkFkb25pcy9Db3JlL0h0dHBDb250ZXh0J1xuaW1wb3J0ICBVc2VyICBmcm9tICdBcHAvTW9kZWxzL1VzZXInXG5cbnRlc3QuZ3JvdXAoJ0ZldGNoU2luZ2xlT3JnYW5pc2F0aW9uQ29udHJvbGxlcicsIChncm91cCkgPT4ge1xuICAgIGxldCBzYW5kYm94OiBzaW5vbi5TaW5vblNhbmRib3hcblxuICBncm91cC5zZXR1cChhc3luYyAoKSA9PiB7XG4gICAgXG4gICAgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKVxuICB9KVxuXG4gIGdyb3VwLnRlYXJkb3duKGFzeW5jICgpID0+IHtcbiAgICBzYW5kYm94LnJlc3RvcmUoKVxuICB9KSBcblxuICBncm91cC5lYWNoLnRlYXJkb3duID0gKCkgPT4ge1xuICAgIHNhbmRib3gucmVzdG9yZSgpXG4gIH1cblxuXG4gIHRlc3QoJ3Nob3VsZCByZXR1cm4gMjAwIGFuZCBvcmdhbmlzYXRpb24gZGF0YSBpZiBvcmdhbmlzYXRpb24gaXMgZm91bmQnLCBhc3luYyAoeyBhc3NlcnQgfSkgPT4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgRmV0Y2hTaW5nbGVPcmdhbmlzYXRpb25Db250cm9sbGVyKClcblxuICAgIGNvbnN0IGZha2VVc2VyID0geyB1c2VySWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnIH0gYXMgVXNlclxuICAgIGNvbnN0IG9yZ0lkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMSdcbiAgICBjb25zdCBmYWtlT3JnYW5pc2F0aW9ucyA9IFt7IG9yZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJywgbmFtZTogJ1Rlc3QgT3JnJywgZGVzY3JpcHRpb246XCJhIHJhbmRvbSBvcmdhbmlzYXRpb25cIiB9XVxuXG4gICAgc2FuZGJveC5zdHViKFVzZXJBY3Rpb25zLCAnZmV0Y2hVc2VyT3JnYW5pc2F0aW9ucycpLnJlc29sdmVzKGZha2VPcmdhbmlzYXRpb25zKVxuXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgIHBhcmFtOiBzYW5kYm94LnN0dWIoKS5yZXR1cm5zKG9yZ0lkKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgc3RhdHVzOiBzYW5kYm94LnN0dWIoKS5yZXR1cm5zVGhpcygpLFxuICAgICAgc2VuZDogc2FuZGJveC5zdHViKClcbiAgICB9XG5cbiAgICBjb25zdCBhdXRoID0ge1xuICAgICAgdXNlcjogZmFrZVVzZXJcbiAgICB9XG5cbiAgICBjb25zdCBjdHggPSB7IHJlcXVlc3QsIHJlc3BvbnNlLCBhdXRoIH0gYXMgdW5rbm93biBhcyBIdHRwQ29udGV4dENvbnRyYWN0XG5cbiAgICBhd2FpdCBjb250cm9sbGVyLmhhbmRsZShjdHgpXG5cbiAgICBhc3NlcnQuaXNUcnVlKHJlc3BvbnNlLnN0YXR1cy5jYWxsZWRXaXRoKDIwMCkpXG4gICAgYXNzZXJ0LmlzVHJ1ZShyZXNwb25zZS5zZW5kLmNhbGxlZFdpdGgoe1xuICAgICAgc3RhdHVzOiBcInN1Y2Nlc3NcIixcbiAgICAgIG1lc3NhZ2U6IFwiT3JnYW5pc2F0aW9uIGZldGNoZWQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICBkYXRhOiBmYWtlT3JnYW5pc2F0aW9uc1swXVxuICAgIH0pKVxuICB9KVxuXG4gIHRlc3QoJ3Nob3VsZCByZXR1cm4gNDA0IGlmIG9yZ2FuaXNhdGlvbiBpcyBub3QgZm91bmQnLCBhc3luYyAoeyBhc3NlcnQgfSkgPT4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgRmV0Y2hTaW5nbGVPcmdhbmlzYXRpb25Db250cm9sbGVyKClcblxuICAgIGNvbnN0IGZha2VVc2VyID0geyB1c2VySWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnIH0gYXMgVXNlclxuICAgIGNvbnN0IG9yZ0lkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMSdcbiAgICBjb25zdCBmYWtlT3JnYW5pc2F0aW9ucyA9IFt7IG9yZ0lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAyJywgbmFtZTogJ090aGVyIE9yZycsIGRlc2NyaXB0aW9uOiBcIm5pY2UgZGVzY3JpcHRpb25cIiB9XVxuXG4gICAgc2FuZGJveC5zdHViKFVzZXJBY3Rpb25zLCAnZmV0Y2hVc2VyT3JnYW5pc2F0aW9ucycpLnJlc29sdmVzKGZha2VPcmdhbmlzYXRpb25zKVxuXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgIHBhcmFtOiBzYW5kYm94LnN0dWIoKS5yZXR1cm5zKG9yZ0lkKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0ge1xuICAgICAgc3RhdHVzOiBzYW5kYm94LnN0dWIoKS5yZXR1cm5zVGhpcygpLFxuICAgICAgc2VuZDogc2FuZGJveC5zdHViKClcbiAgICB9XG5cbiAgICBjb25zdCBhdXRoID0ge1xuICAgICAgdXNlcjogZmFrZVVzZXJcbiAgICB9XG5cbiAgICBjb25zdCBjdHggPSB7IHJlcXVlc3QsIHJlc3BvbnNlLCBhdXRoIH0gYXMgdW5rbm93biBhcyBIdHRwQ29udGV4dENvbnRyYWN0XG5cbiAgICBhd2FpdCBjb250cm9sbGVyLmhhbmRsZShjdHgpXG5cbiAgICBhc3NlcnQuaXNUcnVlKHJlc3BvbnNlLnN0YXR1cy5jYWxsZWRXaXRoKDQwNCkpXG4gICAgYXNzZXJ0LmlzVHJ1ZShyZXNwb25zZS5zZW5kLmNhbGxlZFdpdGgoe1xuICAgICAgc3RhdHVzOiBcIkJhZCBSZXF1ZXN0XCIsXG4gICAgICBtZXNzYWdlOiBcIk9yZ2FuaXNhdGlvbiByZWNvcmQgbm90IGZvdW5kXCIsXG4gICAgICBkYXRhOiB1bmRlZmluZWRcbiAgICB9KSlcbiAgfSlcblxuICB0ZXN0KCdzaG91bGQgcmV0dXJuIDUwMCBpZiBhbiBlcnJvciBvY2N1cnMnLCBhc3luYyAoeyBhc3NlcnQgfSkgPT4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgRmV0Y2hTaW5nbGVPcmdhbmlzYXRpb25Db250cm9sbGVyKClcblxuICAgIGNvbnN0IGZha2VVc2VyID0geyB1c2VySWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnIH0gYXMgVXNlclxuICAgIGNvbnN0IG9yZ0lkID0gJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMSdcblxuICAgIHNhbmRib3guc3R1YihVc2VyQWN0aW9ucywgJ2ZldGNoVXNlck9yZ2FuaXNhdGlvbnMnKS50aHJvd3MobmV3IEVycm9yKCdTaW11bGF0ZWQgZXJyb3InKSlcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICBwYXJhbTogc2FuZGJveC5zdHViKCkucmV0dXJucyhvcmdJZClcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IHtcbiAgICAgIHN0YXR1czogc2FuZGJveC5zdHViKCkucmV0dXJuc1RoaXMoKSxcbiAgICAgIHNlbmQ6IHNhbmRib3guc3R1YigpXG4gICAgfVxuXG4gICAgY29uc3QgYXV0aCA9IHtcbiAgICAgIHVzZXI6IGZha2VVc2VyXG4gICAgfVxuXG4gICAgY29uc3QgY3R4ID0geyByZXF1ZXN0LCByZXNwb25zZSwgYXV0aCB9IGFzIHVua25vd24gYXMgSHR0cENvbnRleHRDb250cmFjdFxuXG4gICAgYXdhaXQgY29udHJvbGxlci5oYW5kbGUoY3R4KVxuXG4gICAgYXNzZXJ0LmlzVHJ1ZShyZXNwb25zZS5zdGF0dXMuY2FsbGVkV2l0aCg1MDApKVxuICAgIGFzc2VydC5pc1RydWUocmVzcG9uc2Uuc2VuZC5jYWxsZWRXaXRoKHtcbiAgICAgIHN0YXR1czogXCJFcnJvclwiLFxuICAgICAgbWVzc2FnZTogXCJFcnJvciBPY2N1cmVkIEZldGNoaW5nIE9yZ2FuaXNhdGlvblwiLFxuICAgICAgc3RhdHVzQ29kZTogNTAwXG4gICAgfSkpXG4gIH0pXG59KVxuIl19